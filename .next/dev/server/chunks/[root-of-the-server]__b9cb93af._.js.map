{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///home/premkumar/Documents/GitHub/Persona-Client1/app/api/%5B...path%5D/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\n\nconst BACKEND_URL =\n    process.env.NEXT_PUBLIC_API_URL || \"http://localhost:8000\";\n\nfunction backendUnreachable(err: unknown) {\n    return NextResponse.json(\n        { error: \"Backend unreachable\", detail: String(err) },\n        { status: 503 }\n    );\n}\n\nasync function parseJson(res: Response): Promise<NextResponse> {\n    try {\n        const data = await res.json();\n        return NextResponse.json(data, { status: res.status });\n    } catch {\n        return NextResponse.json(\n            { error: \"Invalid response from backend\", status: res.status },\n            { status: res.status }\n        );\n    }\n}\n\nexport async function GET(\n    request: NextRequest,\n    { params }: { params: Promise<{ path: string[] }> }\n) {\n    const { path } = await params;\n    const pathStr = path.join(\"/\");\n    const searchParams = request.nextUrl.searchParams.toString();\n    const url = `${BACKEND_URL}/api/${pathStr}${searchParams ? `?${searchParams}` : \"\"}`;\n\n    try {\n        const res = await fetch(url, {\n            headers: { \"Content-Type\": \"application/json\" },\n        });\n\n        // Check if response is a video/audio file (binary stream)\n        const contentType = res.headers.get(\"content-type\") || \"\";\n        if (contentType.startsWith(\"video/\") || contentType.startsWith(\"audio/\")) {\n            // Stream the binary content directly\n            const blob = await res.blob();\n            return new NextResponse(blob, {\n                status: res.status,\n                headers: {\n                    \"Content-Type\": contentType,\n                    \"Content-Disposition\": res.headers.get(\"content-disposition\") || \"inline\",\n                },\n            });\n        }\n\n        return parseJson(res);\n    } catch (err) {\n        return backendUnreachable(err);\n    }\n}\n\nexport async function POST(\n    request: NextRequest,\n    { params }: { params: Promise<{ path: string[] }> }\n) {\n    const { path } = await params;\n    const pathStr = path.join(\"/\");\n    const url = `${BACKEND_URL}/api/${pathStr}/`;\n\n    const contentType = request.headers.get(\"content-type\") || \"\";\n\n    try {\n        let res: Response;\n        if (contentType.includes(\"multipart/form-data\")) {\n            const formData = await request.formData();\n            res = await fetch(url, {\n                method: \"POST\",\n                body: formData,\n            });\n        } else {\n            const body = await request.text();\n            res = await fetch(url, {\n                method: \"POST\",\n                headers: { \"Content-Type\": \"application/json\" },\n                body,\n            });\n        }\n        return parseJson(res);\n    } catch (err) {\n        return backendUnreachable(err);\n    }\n}\n\nexport async function DELETE(\n    request: NextRequest,\n    { params }: { params: Promise<{ path: string[] }> }\n) {\n    const { path } = await params;\n    const pathStr = path.join(\"/\");\n    const url = `${BACKEND_URL}/api/${pathStr}/`;\n\n    try {\n        const res = await fetch(url, { method: \"DELETE\" });\n        return parseJson(res);\n    } catch (err) {\n        return backendUnreachable(err);\n    }\n}\n"],"names":[],"mappings":";;;;;;;;AAAA;;AAEA,MAAM,cACF,QAAQ,GAAG,CAAC,mBAAmB,IAAI;AAEvC,SAAS,mBAAmB,GAAY;IACpC,OAAO,iTAAY,CAAC,IAAI,CACpB;QAAE,OAAO;QAAuB,QAAQ,OAAO;IAAK,GACpD;QAAE,QAAQ;IAAI;AAEtB;AAEA,eAAe,UAAU,GAAa;IAClC,IAAI;QACA,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,OAAO,iTAAY,CAAC,IAAI,CAAC,MAAM;YAAE,QAAQ,IAAI,MAAM;QAAC;IACxD,EAAE,OAAM;QACJ,OAAO,iTAAY,CAAC,IAAI,CACpB;YAAE,OAAO;YAAiC,QAAQ,IAAI,MAAM;QAAC,GAC7D;YAAE,QAAQ,IAAI,MAAM;QAAC;IAE7B;AACJ;AAEO,eAAe,IAClB,OAAoB,EACpB,EAAE,MAAM,EAA2C;IAEnD,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM;IACvB,MAAM,UAAU,KAAK,IAAI,CAAC;IAC1B,MAAM,eAAe,QAAQ,OAAO,CAAC,YAAY,CAAC,QAAQ;IAC1D,MAAM,MAAM,GAAG,YAAY,KAAK,EAAE,UAAU,eAAe,CAAC,CAAC,EAAE,cAAc,GAAG,IAAI;IAEpF,IAAI;QACA,MAAM,MAAM,MAAM,MAAM,KAAK;YACzB,SAAS;gBAAE,gBAAgB;YAAmB;QAClD;QAEA,0DAA0D;QAC1D,MAAM,cAAc,IAAI,OAAO,CAAC,GAAG,CAAC,mBAAmB;QACvD,IAAI,YAAY,UAAU,CAAC,aAAa,YAAY,UAAU,CAAC,WAAW;YACtE,qCAAqC;YACrC,MAAM,OAAO,MAAM,IAAI,IAAI;YAC3B,OAAO,IAAI,iTAAY,CAAC,MAAM;gBAC1B,QAAQ,IAAI,MAAM;gBAClB,SAAS;oBACL,gBAAgB;oBAChB,uBAAuB,IAAI,OAAO,CAAC,GAAG,CAAC,0BAA0B;gBACrE;YACJ;QACJ;QAEA,OAAO,UAAU;IACrB,EAAE,OAAO,KAAK;QACV,OAAO,mBAAmB;IAC9B;AACJ;AAEO,eAAe,KAClB,OAAoB,EACpB,EAAE,MAAM,EAA2C;IAEnD,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM;IACvB,MAAM,UAAU,KAAK,IAAI,CAAC;IAC1B,MAAM,MAAM,GAAG,YAAY,KAAK,EAAE,QAAQ,CAAC,CAAC;IAE5C,MAAM,cAAc,QAAQ,OAAO,CAAC,GAAG,CAAC,mBAAmB;IAE3D,IAAI;QACA,IAAI;QACJ,IAAI,YAAY,QAAQ,CAAC,wBAAwB;YAC7C,MAAM,WAAW,MAAM,QAAQ,QAAQ;YACvC,MAAM,MAAM,MAAM,KAAK;gBACnB,QAAQ;gBACR,MAAM;YACV;QACJ,OAAO;YACH,MAAM,OAAO,MAAM,QAAQ,IAAI;YAC/B,MAAM,MAAM,MAAM,KAAK;gBACnB,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C;YACJ;QACJ;QACA,OAAO,UAAU;IACrB,EAAE,OAAO,KAAK;QACV,OAAO,mBAAmB;IAC9B;AACJ;AAEO,eAAe,OAClB,OAAoB,EACpB,EAAE,MAAM,EAA2C;IAEnD,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM;IACvB,MAAM,UAAU,KAAK,IAAI,CAAC;IAC1B,MAAM,MAAM,GAAG,YAAY,KAAK,EAAE,QAAQ,CAAC,CAAC;IAE5C,IAAI;QACA,MAAM,MAAM,MAAM,MAAM,KAAK;YAAE,QAAQ;QAAS;QAChD,OAAO,UAAU;IACrB,EAAE,OAAO,KAAK;QACV,OAAO,mBAAmB;IAC9B;AACJ"}}]
}